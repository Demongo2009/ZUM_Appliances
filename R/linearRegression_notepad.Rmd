
TWORZENIE MODELU REGRESJI LINIOWEJ
https://www.pluralsight.com/guides/linear-lasso-and-ridge-regression-with-r

Wczytanie danych
```{r}
#install.packages("caret")
library(caret)
train<-read.csv("../data/energy_data_train.csv")
train <- subset(train, select = -c(lights) )
train_attributes <- subset(train, select = -c(logAppliances) )
pre_proc_val <- preProcess(train_attributes, method = c("center", "scale"))
test<-read.csv("../data/energy_data_test.csv")
test_attributes <- subset(test, select = -c(lights, logAppliances) )
test_y <- subset(test, select = c( logAppliances) )

train_attributes = predict(pre_proc_val, train_attributes)

test_attributes = predict(pre_proc_val, test_attributes)
logAppliances<-train$logAppliances
train <- cbind(train_attributes, logAppliances)
```

Regrasja liniowa

```{r}
model1 <- lm(logAppliances~.,train,na.action=na.exclude)
summary(model1)
```
predykcja

```{r}
prediction<-predict(model1, newdata = test_attributes)

```
```{r}
#Step 1 - create the evaluation metrics function


eval_metrics = function(model, y, predictions){
    resids = y - predictions
    resids2 = resids**2
    N = length(predictions)
    r2 = as.character(round(summary(model)$r.squared, 2))
    adj_r2 = as.character(round(summary(model)$adj.r.squared, 2))
    print(adj_r2) #Adjusted R-squared
    print(as.character(round(sqrt(sum(resids2)/N), 2))) #RMSE

}

```

```{r}
# Step 2 - predicting and evaluating the model on train data
predictions = predict(model1, newdata = train_attributes)
eval_metrics(model1, train$logAppliances, predictions)


# Step 3 - predicting and evaluating the model on test data
predictions = predict(model1, newdata = test_attributes)
eval_metrics(model1, test_y, predictions)
```

